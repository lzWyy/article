### 读 浏览器的工作原理  笔记
- 浏览器的主要组件
  1. 用户界面
  2. 浏览器引擎
  3. 呈现引擎
  4. 网络
  5. 用户界面后端
  6. JavaScript解释器
  7. 数据存储
 
 - 呈现引擎
    - 呈现引擎用来在浏览器的页面上显示请求的内容，如果是html就按照html解析显示
      1. `Firefox`: Gecko
      2. `Safari` 和 `Chrome`: webkit
    
    - 呈现引擎解析html文档，并将各标记逐个转为“内容树”上的dom节点，同时也会解析外部css，将其挂载在dom数上创建成一个“呈现树”
    - 为了达到更好的用户体验，呈现引擎会尽可能快的将内容显示在屏幕上，不必等到整个html文档解析完毕之后。在不断接收和处理来自网络的其余内容的同时，呈现引擎会将部分内容解析并显示出来。
    
    - 解析： 解析是一个迭代规则，不断取得标记去匹配规则
      
        1. 解析的过程可以分为两个过程：词法分析和语法分析
        2. 词法分析将内容分解成一个个有效的标记，而解析器负责根据语言的语法规则分析文档结构，构建解析树。
        
    - 首先将源代码解析成解析树，然后将解析树翻译成机器代码文档

    - 浏览器对html的解析有容错机制
    - dom树(html)和呈现树是同时构建的，如果在dom树构建完毕，呈现树
    
- web的模式是同步的，如果遇到一个`script`标签就会立即解析执行脚本，并阻塞文档解析，如果脚本是外引，则必须先请求到这个资源，也是同步的。
- 样式表
  1. 样式表的解析和文档的解析也是同步进行的
  2. 如果样式表在文档解析完后还没有加载和解析，Firefox在存在样式表还在加载和解析时阻塞所有的脚本，而Chrome只在当脚本试图访问某些可能被未加载的样式表所影响的特定的样式属性时才阻塞这些脚本。
 
- 样式计算
  >创建渲染树需要通过计算每个元素的样式属性

     1. 样式数据是非常大的结构，保存大量的样式属性会带来内存问题
     2. 为每个元素查找匹配的规则都需要遍历整个规则表
 